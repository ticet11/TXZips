import json
import os
import random

with open(os.path.join(os.path.dirname(__file__),
                       './tx_ip_by_zip.json')) as ip_file:
    zipIPObjs = json.load(ip_file)
    with open(os.path.join(os.path.dirname(__file__),
                           './txzips.json')) as zip_file:
        zipObjs = json.load(zip_file)['zip_codes']
        data = {}
        for zipObj in zipObjs:
            data[zipObj['zip']] = {
                'city': zipObj['city'],
                'countyname': zipObj['countyname'],
                'pop': zipObj['pop'],
            }
            if zipObj['zip'] in zipIPObjs:
                data[zipObj['zip']]['ip_address_ranges'] = zipIPObjs[
                    zipObj['zip']]["ip_address_range"]
            else:
                data[zipObj['zip']]['ip_address_ranges'] = random.choices([
                    '34.9.77.0/24', '34.9.78.0/23', '34.9.80.0/20',
                    '34.9.96.0/19', '34.9.128.0/17', '34.10.0.0/15',
                    '34.12.0.0/14', '34.16.0.0/12', '34.32.0.0/11',
                    '34.64.0.0/10', '34.128.0.0/15', '34.130.0.0/16',
                    '34.131.0.0/17', '34.131.128.0/18', '34.131.192.0/21',
                    '34.131.200.0/22', '34.131.204.0/23', '34.131.207.0/24',
                    '34.131.208.0/20', '34.131.224.0/19', '34.132.0.0/14',
                    '34.136.0.0/13', '34.144.0.0/12', '34.160.0.0/11',
                    '16.35.199.0/24', '16.35.200.0/21', '16.35.208.0/20',
                    '16.35.224.0/19', '16.36.0.0/14', '16.40.0.0/13',
                    '16.48.0.0/12', '16.64.0.0/13', '16.72.0.0/16',
                    '16.73.0.0/17', '16.73.128.0/18', '16.73.192.0/19',
                    '16.186.156.0/22', '16.186.160.0/19', '16.186.192.0/18',
                    '16.187.0.0/16', '16.188.0.0/14', '16.192.0.0/12',
                    '16.208.0.0/14', '16.212.0.0/16', '16.213.0.0/17',
                    '16.213.128.0/18', '16.213.192.0/19', '16.213.224.0/20',
                    '16.213.240.0/21', '16.213.248.0/22', '16.213.252.0/24',
                    '16.160.30.0/23', '16.160.32.0/19', '16.160.64.0/18',
                    '16.160.128.0/17', '16.161.0.0/16', '16.162.0.0/15',
                    '16.164.0.0/14', '16.168.0.0/13', '16.176.0.0/13',
                    '16.184.0.0/15', '16.186.0.0/17', '16.186.128.0/20',
                    '16.186.144.0/21', '16.186.152.0/23', '16.186.154.0/24'
                ],
                                                                          k=2)

with open("tx.json", 'w') as f:
    json.dump(data, f, indent=4)
